<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥µç°¡æ¸¬è©¦</title>
</head>
<body style="padding: 20px; font-family: sans-serif;">

    <h1>ğŸš‘ æ¥µç°¡æ€¥æ•‘æ¨¡å¼</h1>
    <p>å¦‚æœçœ‹åˆ°é€™å€‹ç•«é¢ï¼Œä»£è¡¨ worker.html æª”æ¡ˆæœ¬èº«æ˜¯å¥½çš„ã€‚</p>
    <hr>
    
    <h3>ç‹€æ…‹ï¼š</h3>
    <div id="status" style="font-weight: bold; color: blue;">æº–å‚™é–‹å§‹...</div>
    
    <h3>éŒ¯èª¤è¨Šæ¯ (å¦‚æœæœ‰çš„è©±)ï¼š</h3>
    <div id="debug" style="color: red; margin-top: 10px; border: 1px solid red; padding: 10px; min-height: 50px;"></div>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <script>
        // 1. æŠŠéŒ¯èª¤å°åœ¨ç•«é¢ä¸Šï¼Œä¸è¦è—åœ¨ console è£¡
        window.onerror = function(msg, url, line) {
            document.getElementById('debug').innerHTML += "âŒ ç³»çµ±éŒ¯èª¤: " + msg + "<br>è¡Œæ•¸: " + line + "<br>";
        };

        const LIFF_ID = "2008808827-DzeTt84n";

        async function start() {
            try {
                document.getElementById('status').innerText = "1. æ­£åœ¨åˆå§‹åŒ– LIFF...";
                
                await liff.init({ liffId: LIFF_ID });
                
                document.getElementById('status').innerText = "2. LIFF åˆå§‹åŒ–æˆåŠŸï¼æª¢æŸ¥ç™»å…¥ç‹€æ…‹...";
                
                if (!liff.isLoggedIn()) {
                    document.getElementById('status').innerText = "3. æœªç™»å…¥ï¼Œæ­£åœ¨è·³è½‰ LINE ç™»å…¥...";
                    liff.login();
                } else {
                    const profile = await liff.getProfile();
                    document.getElementById('status').innerHTML = "âœ… æˆåŠŸæŠ“åˆ°è³‡æ–™ï¼<br>ä½ å¥½ï¼Œ" + profile.displayName;
                    
                    // é¡¯ç¤ºå¤§é ­è²¼ç¢ºèªçœŸçš„æŠ“åˆ°äº†
                    document.body.innerHTML += `<br><br><img src="${profile.pictureUrl}" style="width:100px; border-radius:50%; border: 3px solid green;">`;
                }
            } catch (err) {
                document.getElementById('debug').innerText = "åŸ·è¡Œå¤±æ•—: " + err;
            }
        }

        // å•Ÿå‹•ç¨‹å¼
        start();
    </script>
</body>
</html>
